/* =========
   eBook CSS
   ========= */


@font-face{
  font-family: "Literata";
  src: url("fonts/Literata/static/Literata-Regular.ttf") format("truetype");
  font-weight: 400; font-style: normal;
}
@font-face{
  font-family: "Literata";
  src: url("fonts/Literata/static/Literata-Bold.ttf") format("truetype");
  font-weight: 700; font-style: normal;
}
@font-face{
  font-family: "Literata";
  src: url("fonts/Literata/static/Literata-Italic.ttf") format("truetype");
  font-weight: 400; font-style: italic;
}



/* Tweak rapidi */
:root{
  --text-size: 1.05rem;
  --line-height: 1.5;
  --page-h-margin: 7%;
  --heading-color: #6b7280;   /* grigio elegante */
  --text-color: #000000;
  --accent-color: #9ca3af;    /* grigio chiaro per dettagli */
  --caption-size: 0.9rem;

   /* NUOVE per tema seppia */
  --bg-color: #f4ecd8;       /* seppia chiaro */
  --code-bg: #efe6d2;        /* fondo blocchi codice */
  --code-fg: #3b2f2f;        /* testo codice */
  --code-border: #d8c9a7;    /* bordo codice */
}

/* Font stack:
   - “Literata” o “Merriweather” se incorporati
   - altrimenti Palatino/Georgia come fallback eleganti */
html, body{
  margin: 0;
  padding: 0;
}
body{
  font-family: "Literata", "Merriweather", "Palatino Linotype", Palatino, Georgia, "Times New Roman", serif;
  font-size: var(--text-size);
  line-height: var(--line-height);
  color: var(--text-color);
  -webkit-hyphens: auto; hyphens: auto;
  widows: 2; orphans: 2;
  margin: 0 var(--page-h-margin);

  background: var(--bg-color);
}

/* Paragrafi */
p{
  margin: 0 0 0.9em 0;
  text-indent: 0;
}
p + p{
  text-indent: 1.25em;       /* rientro dal 2° paragrafo in poi */
}

/* Titoli capitolo */
h1{
  break-before: page;         /* standard */
  page-break-before: always;  /* fallback */
  text-align: center;
  color: var(--heading-color);
  font-weight: 700;
  letter-spacing: 0.01em;
  line-height: 1.2;
  margin: 2.2em 0 0.6em 0;
}

/* Sottotitoli/sezioni */
h2{
  text-align: center;
  color: var(--heading-color);
  font-weight: 600;
  font-variant-caps: small-caps;
  letter-spacing: 0.04em;
  margin: 1.8em 0 0.5em 0;
}
h3{
  color: var(--heading-color);
  font-weight: 600;
  margin: 1.4em 0 0.4em 0;
}

/* Un piccolo tocco decorativo sotto H1 (compatibile e discreto) */
h1::after{
  content: "—";
  display: block;
  text-align: center;
  color: var(--accent-color);
  font-weight: 400;
  letter-spacing: 0.2em;
  margin-top: 0.35em;
}

/* Immagini e figure */
img{
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0.6em auto;
}
figure{
  margin: 1em 0;
  text-align: center;
}
figcaption{
  font-size: var(--caption-size);
  color: var(--accent-color);
  margin-top: 0.4em;
}

/* Citazioni */
blockquote{
  margin: 1em 1.2em;
  padding-left: 0.9em;
  border-left: 3px solid var(--accent-color);
  color: #333;
}

/* Elementi inline utili */
em{ font-style: italic; }
strong{ font-weight: 700; }
code, pre{
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size: 0.95em;
}

/* Note/footnotes di base (se presenti) */
.footnotes, .endnotes{
  border-top: 1px solid var(--accent-color);
  margin-top: 2em;
  padding-top: 0.6em;
}
.footnotes ol, .endnotes ol{
  padding-left: 1.2em;
}

/* Modalità scura (alcuni lettori la ignorano, ma non nuoce) */
/*
@media (prefers-color-scheme: dark){
  body{ color: #eaeaea; }
  blockquote{ color: #d0d0d0; border-left-color: #6b7280; }
  figcaption{ color: #b7b7b7; }
}
*/
/* Evita che le immagini rompano l’heading in cima pagina */
h1 + figure, h1 + img{
  break-inside: avoid;
}

/* Interruzioni manuali, se vuoi forzarle su altri elementi */
.pagebreak{
  break-before: page; page-break-before: always;
}

blockquote.lyrics{
  font-style: italic;
  margin: 1em 1.2em;
  text-align: left;   /* o center, se ti piace */
  opacity: .95;
}

blockquote.lyrics-code{
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size: 0.95em;
  line-height: 1.45;
  white-space: pre-wrap;   /* preserva gli a capo nei reader reflow */
  margin: 1em 1.2em;
  padding: .8em 1em;
  border: 1px solid var(--accent-color);
  border-radius: .25em;
}

/* se vuoi centrare il blocco:
blockquote.lyrics-code{ text-align: center; } */


/* Stile base per blocchi di codice */
pre.code {
  margin: 1rem 0;
  padding: 1rem 1.25rem;
  background: var(--code-bg);
  color: var(--code-fg);
  border: 1px solid var(--code-border);
  border-radius: 8px;
  overflow: auto;
  line-height: 1.5;
  tab-size: 2;
}
pre.code code {
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size: .95rem;
  white-space: pre;
}

.song-chords pre {
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  white-space: pre;
  line-height: 1.45;
  font-size: 0.75rem;
  background: #0a0a0a0a;
  border: 1px solid #00000010;
  border-radius: 6px;
  padding: .9rem 1rem;
  overflow: auto;
}
.song-note { font-style: italic; opacity: .85; margin-top: .25rem; }

.songtable {
  width: 100%; border-collapse: collapse; table-layout: fixed;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  margin: .8rem 0; border: 1px solid #00000018; border-radius: 8px; overflow: hidden;
}
.songtable caption { text-align: left; font-weight: 600; padding: .4rem .5rem; opacity: .85; }
.songtable th, .songtable td { border: 1px solid #00000010; padding: .2rem .25rem; }
.songtable thead th { background: #00000008; font-size: .85rem; text-align: center; }
.songtable .row-label { width: 64px; background: #00000005; font-weight: 600; text-align: right; padding-right: .35rem; }
.songtable .chord { text-align: center; font-weight: 700; }
.songtable .lyr  { font-weight: 500; }
.songtable .bar-split td { background: #00000005; }
.songtable .msep { border-left: 2px solid #00000026; } /* separatore visivo metà battuta (dopo "2 &") */
.small { font-size: .82rem; opacity: .8; }

@media print {
  /* 1) Disattiva layout che frammenta */
  .flex, .grid, [style*="display:flex"], [style*="display:grid"] {
    display: block !important;
  }

  /* 2) Rendi le figure atomiche */
  figure {
    break-inside: avoid;
    page-break-inside: avoid;              /* fallback vecchio */
    -webkit-column-break-inside: avoid;    /* vecchi WebKit */
    -webkit-region-break-inside: avoid;
    display: table;                        /* hack: più rispettato in print */
    width: 100%;
    overflow: hidden;                      /* evita spezzature strane */
    margin: 0 0 1em 0;                     /* margini semplici (niente collasso) */
  }
  figure img, figure figcaption {
    break-inside: avoid;
    page-break-inside: avoid;
    display: block;
    max-width: 100%;
    height: auto;
  }

  /* 3) Se anche piccole vengono spezzate, forza il fitting verticale */
  figure img.fit-page {
    max-height: 95vh;       /* scala l’immagine per farla stare in una pagina */
    object-fit: contain;
  }

  /* (opzionale) evita lo “spezzarsi prima” delle figure */
  .avoid-break-before {
    break-before: avoid-page;
    page-break-before: auto;
  }

  @page { margin: 18mm; }   /* margini pagina coerenti */
}

@media print{
  .recto{
    /* prova prima queste proprietà moderne */
    break-before: right;
    /* fallback per vecchi motori */
    page-break-before: right;
  }
}

/* Schermo: non far vedere nulla */
.blank-print{ display:none; }

/* Stampa: genera una pagina vuota completa */
@media print{
  .blank-print{
    display:block;
    page-break-before: always;   /* forza il salto prima */
    page-break-after:  always;   /* e dopo (pagina intera vuota) */
    break-before: page;
    break-after:  page;
    height: 0;                   /* niente contenuto visibile */
    background: #fff;            /* resta bianca */
  }
}

@media print{
  /* margini pagina */
  @page { size: A4; margin: 18mm 16mm 20mm 16mm; }

  /* numerazione */
  body{ counter-reset: page; }           /* Chrome/Edge/Firefox incrementano da soli per ogni pagina */
  .print-footer{
    position: fixed;                     /* ripetuto su tutte le pagine */
    left: 0; right: 0; bottom: 10mm;
    text-align: center;
    font-size: 10pt; color: #555;
  }
  .print-footer::after{
    content: "Pagina " counter(page);    /* "X di Y" vedi nota sotto */
  }
}
